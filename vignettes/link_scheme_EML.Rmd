---
title: "Link between emeScheme and EML"
output: rmarkdown::html_vignette
vignette: >
  %\VignetteIndexEntry{Link between emeScheme and EML}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
---

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "##>"
)
```

```{r setup}
library(emeScheme)
```

# Introduction
This documents illustrated the link between ethe  `emeScheme` and [EML](https://eml.ecoinformatics.org). It is work in progress.

# Approach and Mapping

???OP: Explain why the following is necessary.?? It is essential that only one data file is described and only one method is used in the data file. An emeScheme object containing more than one data file must be split into multiple metadata files with one data file per metadata file by using `dmdScheme:::as_xml.dmdSchemeSet()` to export and split the file - will be done automatically eventually.

At the moment, only a `emeScheme` -> dmdScheme `EML` is implemented. It is done by using the [EML package](https://CRAN.R-project.org/package=EML) in R.

The following section gives the mapping between `emeScheme` and `EML`.

## Experiment
- name ->
- temperature -> 
- light -> 
- humidity -> 
- incubator -> 
- container -> 
- microcosmVolume -> 
- mediaType -> 
- mediaConcentration -> 
- cultureConditions -> 
- comunityType -> 
- mediaAdditions -> 
- duration -> 
- comment -> 
 
## Species
- speciesID ->
- name -> 
- strain -> 
- source -> 
- density -> 
- functionalGroup -> 
- comment -> 
 
## Treatment
- treatmentID -> `factors$attributeName`
- unit -> `factors$definition`
- treatmentLevel -> 
  - unit != "" -> different factor levels / codes, will be split into `factors$code`
- comment -> `factors$definition`

## Measurement
- measurementID -> 
- variable -> 
- method -> 
- unit -> `attributes$unit`
- object -> 
- noOfSamplesInTimeSeries -> 
- samplingVolume -> 
- dataExtractionID -> 
- measuredFrom -> 
- comment -> 

## DataExtraction
- dataExtractionID
- method -> 
- parameter -> 
- value -> 
- comment -> 
 
## DataFileMetaData
- dataFileName -> 
- columnName -> `attributes$attributeName`
- columnData -> defines meaning of mappingColumn (see below)
- mappingColumn ->
  - columnData = "ID" -> 
  - columnData = "Treatment" -> 
  - columnData = "Measurement" -> 
  - columnData = "Species" -> 
  - columnData = "other" -> 
- type -> `attributes$numberType`
- description -> 
  - type = "datatime" -> `attributes$formatString`
  - else -> `attributes$attributeDefinition`
- comment -> `attributes$attributeDefinition`
