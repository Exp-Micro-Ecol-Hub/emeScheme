<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1">

<meta name="author" content="Owen and Rainer" />

<meta name="date" content="2019-12-20" />

<title>User manual for experimental microbial ecology metadata tool</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#header {
text-align: center;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; }  code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">User manual for experimental microbial ecology metadata tool</h1>
<h4 class="author">Owen and Rainer</h4>
<h4 class="date">2019-12-20</h4>



<div id="todo" class="section level1">
<h1><strong><span style="color:red">TODO</span></strong></h1>
</div>
<div id="introduction" class="section level1">
<h1>Introduction</h1>
<p>Researchers are increasingly required to make the data they produce <strong>F</strong>indable, <strong>A</strong>ccessible, <strong>I</strong>nteroperable, and <strong>R</strong>eusable (<a href="https://en.wikipedia.org/wiki/FAIR_data">wikipedia FAIR entry</a>). Providing metadata that describes our studies, experiments, treatments, measurements, data, and so on is a key part of this endeavour.</p>
<p>The aim of the experimental microbial ecology metadata tool (<code>emeScheme</code> R package on <a href="https://github.com/Exp-Micro-Ecol-Hub/emeScheme">https://github.com/Exp-Micro-Ecol-Hub/emeScheme</a>) and the associated experimental microbial ecologal experiments metadata scheme (<code>emeScheme</code> scheme package on <a href="https://github.com/Exp-Micro-Ecol-Hub/dmdSchemeRepository">https://github.com/Exp-Micro-Ecol-Hub/dmdSchemeRepository</a>) is to help you describe your study and its data, i.e. to produce useful metadata. You will do this by</p>
<ol style="list-style-type: decimal">
<li>Preparing your datasets for archiving (see <a href="#PrepareDataForArchiving">Prepare Data for Archiving</a>),</li>
<li>Filling in your metadata the spreadsheet supplied (see <a href="#FillInMetadata">Fill in Metadata</a>),</li>
<li>Validating the combination of the metadata and data (this will be largely automatic) (see <a href="#Validation">Validation</a>),</li>
<li>Fixing any issues revealed by the validation step, and once satisfactorily validated (see <a href="#Fixing">Fixing issues</a>),</li>
<li>Deposit the metadata and data in a repository of your choice (see <a href="#depositing">Depositing in a repository</a>).</li>
</ol>
</div>
<div id="what-is-useful-metadata" class="section level1">
<h1>What is <em>useful</em> metadata?</h1>
<p>Imagine we would like to use the metadata to find experiments (and potentially return the relevant data from them) that involve <em>Colpidium striatum</em> grown at <strong>20ºC</strong> in <strong>0.55g per litre protist pellet medium</strong>. To do this we need to ensure that the <strong>species name</strong>, the <strong>temperature</strong>, and the <strong>growth media information</strong> are contained in the metadata. We also need to make sure that when temperature is described it is described in a <strong>standard fashion</strong>, and that the growth media description is standardised. So there must be some standardisation. But its clear that most experiments have some unique features, such that we can’t standardise everything in advance. The metadata scheme we use here is intended to be a good balance of standardised and flexible.</p>
</div>
<div id="what-metadata-is-covered-in-the-emescheme-and-what-is-not" class="section level1">
<h1>What metadata is covered in the emeScheme, and what is not</h1>
<p>The emeScheme metadata only covers that necessary/helpful to describe an “experimental microbial ecology” study (though as an aside we think/wonder if it might be useful for many other settings of ecological experiments). Other important/essential metadata is not included, and will not be included, <strong>in the emeScheme</strong> because it is in other schemes such as the <em>DataCite</em> scheme and/or the <em>Ecological Metadata Language/Scheme</em>. We may, however, add tools that help researchers enter this important/essential metadata also.</p>
</div>
<div id="at-what-point-of-my-study-should-i-enter-metadata" class="section level1">
<h1>At what point of my study should I enter metadata</h1>
<p>You will benefit from starting metadata entry when you design your study. You’ll likely find out that doing to will help with the planning of the study. You may then choose to work in a slightly different way, since this will make things more efficient later (this might especially be so for data handling issues). No problem, however, if you decide to do it at the end (or you are reading this after a study is complete).</p>
</div>
<div id="getting-started" class="section level1">
<h1>Getting started</h1>
<p>You will enter the metadata in a supplied spreadsheet (Googlesheets or Excel), but then use R to do some tasks, like validation and transormation of metadata into more machine readable form. So the first thing to do is get and load the <strong>emeScheme</strong> R package:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co">## install the devtools package if not installed yet</span></span>
<span id="cb1-2"><a href="#cb1-2"></a><span class="co">## install.packages(&quot;devtools&quot;)</span></span>
<span id="cb1-3"><a href="#cb1-3"></a></span>
<span id="cb1-4"><a href="#cb1-4"></a><span class="co">## as the packages are not yet on CRAN, you have to install the package dmdScheme from github first</span></span>
<span id="cb1-5"><a href="#cb1-5"></a></span>
<span id="cb1-6"><a href="#cb1-6"></a><span class="co"># devtools::install_github(&quot;Exp-Micro-Ecol-Hub/dmdScheme&quot;, ref = &quot;master&quot;, build_opts = c(&quot;--no-resave-data&quot;))</span></span>
<span id="cb1-7"><a href="#cb1-7"></a></span>
<span id="cb1-8"><a href="#cb1-8"></a><span class="co">## to install the newest version emeScheme from github including the vignettes, run:</span></span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># devtools::install_github(&quot;Exp-Micro-Ecol-Hub/emeScheme&quot;, build_opts = NULL)</span></span>
<span id="cb1-11"><a href="#cb1-11"></a></span>
<span id="cb1-12"><a href="#cb1-12"></a><span class="co">## than load the package</span></span>
<span id="cb1-13"><a href="#cb1-13"></a><span class="kw">library</span>(emeScheme)</span></code></pre></div>
<pre><code>## Loading required package: dmdScheme</code></pre>
<pre><code>## 
## #############################################
## The cache will be in a temporary location and be deleted when you quit R.
## It is located at
##    /var/folders/50/wcr5bjwn75q595n6x82gxj280000gq/T//RtmpfyRO9e/dmdScheme_76852cdaa69b
## To make it permanent, call
##    cache(createPermanent = TRUE)
## and restart R
## and a permanent cache will be created which will survive restarts.
## #############################################</code></pre>
<pre><code>## Scheme definition `/var/folders/50/wcr5bjwn75q595n6x82gxj280000gq/T//RtmpfyRO9e/file768546f0211e/dmdScheme_0.9.5.tar.gz, installed with
## name:    dmdScheme
## version: 0.9.5</code></pre>
<pre><code>## Theme switched to dmdScheme_0.9.5</code></pre>
<pre><code>## Scheme definition `/var/folders/50/wcr5bjwn75q595n6x82gxj280000gq/T//RtmpfyRO9e/file76853f0e5cf4/emeScheme_0.9.5.tar.gz, installed with
## name:    emeScheme
## version: 0.9.5</code></pre>
<pre><code>## Theme switched to emeScheme_0.9.5</code></pre>
<p>This will do several things:</p>
<ol style="list-style-type: decimal">
<li>Download and install the scheme definition for the <code>emeScheme</code> and install it in a temporary scheme library by running <code>scheme_install(&quot;emeScheme&quot;, &quot;0.9.5)</code></li>
<li>activate the new scheme definition by calling <code>scheme_use(&quot;emeScheme&quot;, &quot;0.9.5&quot;</code></li>
</ol>
<p>This wil be done each time you load the package in a new session, as the session library is only temporary.</p>
<p>To make this library permanent, run</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="kw">cache</span>(<span class="dt">createPermanent =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>and restart your R session. This will create a permanent cache which is used for the scheme library in your user directory, so that schemes are installed permanently. For details on the managing of schemes, see <a href="https://exp-micro-ecol-hub.github.io/dmdScheme/r_package_introduction.html">vignette R r_package_introduction or on the web</a>.</p>
<p>To enter the metadata run this R command to get an Excel version of the emeScheme without metadata in it:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="kw">open_new_spreadsheet</span>()</span></code></pre></div>
<p>The following command opens the sheet with the example data in:</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a><span class="kw">open_new_spreadsheet</span>(<span class="dt">keepData =</span> <span class="ot">TRUE</span>)</span></code></pre></div>
<p>Either way, make a copy of the spreadsheet and save it somewhere safe, like in the folder for your study/experiment .</p>
<p>Its probably worth now looking at the spreadsheet (but don’t yet try to fill in anything), to see what metadata you will need to enter. There are several worksheets:</p>
<ul>
<li><strong>Experiment</strong> Here you enter details of your experiment, e.g. what temperature was the experiment conducted at. If temperature was a treatment, then you state that here and supply the levels in the <strong>Treatments</strong> worksheet.</li>
<li><strong>Species</strong> Give details of the species involved in the experiment. If the species are unknow, enter <code>unknown</code>,</li>
<li><strong>Treatments</strong> Here we give the manipulations involved in the experiment.</li>
<li><strong>Measurements</strong> Details of what was measured, and how data was extracted from the measurements.</li>
<li><strong>DataExtraction</strong> Details of how measurements were extracted from raw data, if that happened.</li>
<li><strong>DataFileMetaData</strong> Details of the data files, description of the variables they contain, and validation conditions for the data.</li>
</ul>
</div>
<div id="PrepareDataForArchiving" class="section level1">
<h1>Preparing data for archiving</h1>
<p>There are no hard and fast rules, but there are some guidelines that will make things easier, or are otherwise recommended for datasets (e.g. data that we can have in a spreadsheet):</p>
<ul>
<li>Use long / tidy arrangement of data.</li>
<li>Always include a variable for each treatment.</li>
<li>Always include a variable that allows one data file to be related to others (e.g. Microcosm_ID).</li>
<li>Put all measurement of one type in a single data file. E.g. one datafile of dissolved oxygen measures, one datafile of adundance data, one data file of sequence data, containing all measurements from all treatments.</li>
</ul>
<p>If your data does not fit these guidelines, e.g. is a collection of videos files or a collection of files containing DNA sequence data, put it in a container of some kind (e.g. compressed folder (tar.gz preferably) or zip file) and describe this in the metadata.</p>
<div id="about-dates-and-times" class="section level2">
<h2>About dates and times</h2>
<p>It will be very useful if during data preparation you standardise (parse) any dates and times in the data. A good method for this is to use functions in the <strong>lubridate</strong> R package, such as <code>dmy</code>, <code>hms</code>, and <code>dmy_hms</code> to create the standardise dates, and then write these to the ready for research/archiving data version.</p>
<!-- TODO Should be adapted to the Excel sheet! -->
<!-- ## A note on allowed entries in the **google** version of the spreadsheet -->
<!-- For some cells there are suggested entries listed in the row **suggestedValues** or available in a dropdown list. **Please use these suggestions if you can**. You can enter an item not in the provided list: just type what you like in the cell. If you do this, you will get the message "Invalid: Input must be an item on specified list". You can ignore this message.  -->
</div>
<div id="a-worked-example-of-preparation-of-data-for-archiving" class="section level2">
<h2>A worked example of preparation of data for archiving</h2>
<p>The package <code>emeScheme</code> includes examples of raw data, processing scripts, processed data for archiving and the associated metadata.</p>
<p>The examples (so far only one) are: - <code>basic</code>: a basic simple example</p>
<p>More examples will follow later.</p>
<p>You can always see a list of examples included in the active scheme by running the command</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw">make_example</span>()</span></code></pre></div>
<pre><code>## Included examples are:</code></pre>
<pre><code>## basic
## ex_2</code></pre>
<p>You can get one of the examples, e.g. the basic example by running:</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw">make_example</span>(<span class="st">&quot;basic&quot;</span>)</span></code></pre></div>
<p>This will copy the basic example into your current working directory in a folder named <code>basic</code>.</p>
<p>The worked <strong>basic</strong> example shows appropriate preparation of data for archiving and ease of further use. Its an example of what you could do, not what you have to do, though probably you benefit from doing something similar.</p>
<p>The <code>basic</code> folder contains:</p>
<ul>
<li>An R-project file <code>expt1.Rproj</code></li>
<li>A spreadsheet file <code>expt1_emeScheme.xlsx</code></li>
<li>A folder named <code>data</code> with two subfolders:
<ul>
<li>A <code>raw_data</code> folder containing files and folders of files that contain the data as it was entered by the researcher, or produced by the measurement machine.</li>
<li>A <code>archiving_data</code> folder containing data files that have been prepared for archiving.</li>
</ul></li>
<li>A <code>code</code> folder containing two files:
<ul>
<li><code>data_preparation.Rmd</code> containing code that takes the information in the files in the <code>raw_data</code> folder, prepares this information for easy use by researchers (which also makes them suitable for archiving), and then writes this nicely prepared information/data into files in the <code>archiving_data</code> folder.</li>
<li><code>analyses.Rmd</code> starts by reading the nicely prepared data files from the <code>archiving_data</code> folder, and would then proceed with analyses.</li>
</ul></li>
</ul>
<p><strong>You will not be able to use the code in <code>data_preparation.Rmd</code> outside thias example as it is highly specific to this example.</strong></p>
<p><strong>Note</strong> that it is <strong>very important</strong> thet the preparation of the data for easy use by researchers and for archiving (done in <code>data_preparation.Rmd</code>) in no way changes, subsets, or otherwise manipulates the data. It is just a rearrangement of the raw data and addition of treatment and other useful information.</p>
<p>If you want to try it, delete all the files in the <code>data/archiving_data</code> foilder and knit the <code>data_preparation.Rmd</code> or execute / source the <code>data_preparation.R</code> file which will re-create the files in the <code>archiving_data</code> folder.</p>
<p>Super. Now we have nicely prepared data. We are ready to fill in the metadata.</p>
</div>
</div>
<div id="FillInMetadata" class="section level1">
<h1>Fill in the Metadata</h1>
<p>There’s no more putting it off… lets try filling in the metadata. First, find and open your copy of the metadata spreadsheet you made.</p>
<p>If you’re working through the worked example (<code>basic</code>), open the <code>expt1_emeScheme.xlsx</code> file.</p>
<ul>
<li>Green cells are where you enter information.</li>
<li>Pink cells are places where you should not try to type anything (they should be locked anyway).</li>
</ul>
<p>Two important points to remember: 1. <strong>Please don’t not use any formulas! Only enter values directly! Formulas can (and likely will) cause strange messages later!</strong> 2. <strong>Enter in cells, which do not have a value for your data set, “NA”. This avoids misunderstandings. The <code>comment</code> column can be left empty if you don’t have any additional remarks.</strong></p>
<div id="experiment-worksheet" class="section level2">
<h2>Experiment worksheet</h2>
<p>This one should not need too much explanation. One important point is, however, what to enter in a field (e.g. temperature) if your experiment involved different temperatures (i.e. temperature was a treatment). The answer is you should enter the word “treatment”.</p>
<p>When you fill in this information, think about standardisation. If you enter a temperature, you should therefore enter only a numeric value in degrees Celcius. Writing “twelve degrees” is going to be quite unhelpful! (We could constrain the possible entries here, but then we lose flexibility; recall the discussion above about balancing standardisation and flexibility.)</p>
<p>Something else of note: Look at the field <code>mediaAdditions</code> and you will see the entry is “Wheat seeds added on specific dates, see file wheat_seed_additions.csv”. Here we see the possibility for great flexibility… we refer to information in a separate data file. Note though that this data file is just a list of dates and number of wheat seeds added–it is not information about an experimental treatment, because all experimental treatments experience the same additions (i.e. these additions are feature of the experiment). In addition, the information in these additional files is <strong>not indexed</strong> when submitting the data to a repository for archiving. In other words: researcher will be able to search for all entries in this metadata sheet, but not be able to directly search the data in the data files (data files, additional files as wheat_seet_additions.csv)! So such information as is in the wheat_seed_additions.csv file are effectively hidden from such searches. This is an example of flexibility dominating over standardisation, with some findability thereby being lost.</p>
<p>If you believe that other features of your experiment are important to include, please do so by adding these in the <code>comment</code> row.</p>
</div>
<div id="species-worksheet" class="section level2">
<h2>Species worksheet</h2>
<p>This worksheet should also not need much explanation. Note that this is just a list of the species in the experiment. Its not a description of any treatments involving species composition. These have to be specified in the <code>Treatment</code> worksheet.</p>
<p>During validation of your metadata the species names will be automatically checked against an online database of species names, and you will get a report on matches or lack of matches. (This helps increase interoperability of the data.)</p>
<p>In the worked example the experiment was set up by adding a pool of unknown species composition (Tetrahymena thermophila only added for illustrative purposes). So no entries in this worksheet. The composition could be “measured” using e.g. molecular methods, and would then be an entry in the <strong>Measurements</strong> worksheet (see below for more details on that worksheet).</p>
<p>If any of your data sets contain species names, it will be very helpful to make them match the names in this sheet. You will be told about the presence or absence of such matches in the validation report.</p>
</div>
<div id="treatments-worksheet" class="section level2">
<h2>Treatments worksheet</h2>
<p>Here enter in each row each of the treatment levels in each treatment. In the “parameter” column put the name of the treatment (in the worked example this is “Lid_treatment”).</p>
<p>You do not need to, and should not, attempt to include information about treatment combinations. So if your experiment involved a temperature treatment with three levels (15, 20, and 25) and a species composition treatment with four treatments (species A alone, species B alone, species C alone, and all three together) you would enter seven rows of information. You would not enter 12 rows if your experiment was a two-way fully factorial design with these two treatments.</p>
<p>It would be very nice here (i.e. it will make your life easier) to make the names of your treatment and the descriptions of the levels exactly the same as those used in the related columns in your data files. You will be told about the presence or absence of such matches in the validation report.</p>
<p>As species composition can be seen as a form of treatment, they have to be entered here. I this case, the <code>unit</code> should be <strong>speciesID</strong> and the <code>treatmentLevel</code> should contain a comma separated list of <code>speciesID</code>s.</p>
</div>
<div id="measurements-worksheet" class="section level2">
<h2>Measurements worksheet</h2>
<p>Here enter a row of information for each type of measurement made. In the worked example there are four types of measurement: oxygen concentration, community composition, smell, and DNA sequences. Much of the information required in the rows should be quite self explanatory, apart perhaps from:</p>
<ul>
<li><code>dataExtractionID</code>: Fill in something here if the measurement required some processing of another data file / measurement. E.g. in the worked example the commmunity composition measure (<strong>abundance</strong>) comes from the <strong>sequenceData</strong> data (<code>measuredFrom</code> coumn) by extraction method <strong>Mol_Analy_pipeline1</strong> (see <a href="#DataExtraction">DataExtraction</a> for further details).</li>
<li><code>measuredFrom</code>: should be one of the names of the other rows of measurements. E.g. in the worked example the community composition measure comes from the <strong>sequenceData</strong> measurement, or <code>raw</code> if it is raw data directly from the measurements.</li>
</ul>
<p>It would be <strong>very</strong> nice/useful (i.e. make your life easier) if the entries in the <code>measurementID</code> column correspond with the names of the columns in the data file containing the data (see <a href="#DataFileMetaData">DataFileMetaData</a> for further details). You will be told about the presence or absence of such matches in the validation report.</p>
</div>
<div id="dataextraction-worksheet" class="section level2">
<h2>DataExtraction worksheet</h2>
<p>Here you can give details of any (and please all - this will be validated in the validation report) data extraction methods mentioned in the <strong>Measurements</strong> worksheet. You can enter any parameters and values of these you like (i.e. there is high flexibility here because we do not anticipate a lot of standardisation to exploit). In the worked example we wrote “See description in file xxx.yyy”. This file could be a script or text description of the pipeline.</p>
</div>
<div id="datafilemetadata-worksheet" class="section level2">
<h2>DataFileMetaData worksheet</h2>
<p>Here you give a row for each of the variables in each of the data files.</p>
<ul>
<li><strong>dataFileName</strong> Here enter the file name of the data file.</li>
<li><strong>columnName</strong> Here enter the name used in the datasheet / database / tabular data. This can be the exact name, a regular expression, or an expression with wildcards (<code>*</code> and <code>?</code>). If wildcards has used, they need to be enclosed in triple exclamation marks, i.e. <code>Species_!!!*!!!</code> would match <code>Species_1</code> as well as <code>Species_123</code>. If the <em>columnData</em> <em>mappingColumn</em> combination refers to a condition for the whole data file, e.g. when only one species combination is used in the experiment from this data set, than enter <em>NA</em>.</li>
<li><strong>columnData</strong> Here enter whether the variable/column in the datafile contains a <em>Measurement</em>, a <em>Treatment</em>, an <em>ID</em> variable, <em>Species</em> or something else (<em>other</em>).</li>
<li><strong>mappingColumn</strong> If
<ul>
<li><strong>columnData = Measurement</strong>: enter the <em>measurementID</em> as entered in the <em>Measurement</em> sheet,</li>
<li><strong>columnData = Treatment</strong>: enter the <em>treatmentID</em> as entered in the <em>Treatment</em> sheet,</li>
<li><strong>columnData = Species</strong>: enter the <em>treatmentID</em> as entered in the <em>Treatment</em> sheet which refers to the species composition as <code>treatmentLevel</code>, or <em>NA</em>.</li>
</ul></li>
<li><strong>type</strong> Enter the variable type (e.g. numeric, character, date).</li>
<li><strong>description</strong> Anything you think relevant. Please enter the date/time format for variables that contain date/times.</li>
</ul>
<p>You will get a report on things such as matches and lack of matches with entered variable names and those in the actual datasets, matches of treatment names and measurement names, absences of data about things that were measured, absence about treatment information for things that were measured, and so on.</p>
<p>Note that the example contains a datafile in this worksheet that does not exist in the data folder. This is intended to simulate an error (i.e. forgetting to include a datafile) and to then result notification of this error in the validation report.</p>
</div>
</div>
<div id="Validation" class="section level1">
<h1>Validation</h1>
<p><strong><span style="color:red">This is work in progress. Please give it a go and have a look at the produced validation report, but note that we are leaving most of the development to the next stage of development.</span></strong></p>
<p>After entering your data, you should do a validation test of your metadata and data. The validation will check many different aspects of your metadata and data, and returns a report (html, pdf, docx or all three). The validation and resulting report is a work in progress</p>
<p>To produce a validation report, use the <code>report</code> function and give it your spreadsheet, the path to your data folder, and the type of report you want:</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a><span class="kw">report</span>(<span class="st">&quot;thenameofyourmetadataspreadsheet.xlsx&quot;</span>, <span class="dt">path =</span> <span class="st">&quot;the/path/to/your/datafiles&quot;</span>, <span class="dt">report =</span> <span class="st">&quot;html&quot;</span>)</span></code></pre></div>
<p>As mentioned already, the validation and resulting report is a work in progress. Don’t feel the need to look at it so hard. Please let us know if you suggest particular validation checks.</p>
</div>
<div id="Fixing" class="section level1">
<h1>Fixing issues</h1>
<p>The validation report will suggest improvement you can make to your metadata. It may also say that some changes/additions are <em>required</em> in order to produce valid metadata. The more of these improvements you can make, the more useful will be your metadata-data combination.</p>
</div>
<div id="making-the-final-xml-version" class="section level1">
<h1>Making the final xml version</h1>
<p>The Excel version of the metadata is most useful for us to enter the metadata easily. It is not so useful for standardised/automated metadata enquiry/search/submission… i.e. Excel versions of metadata are not really FAIR compliable. The metadata gurus decided that it should be stored as xml files, as it is plain text, it is in principle readable by humans (though is not meant to be read by humans really), it is machine readable (and then easily converted into any other format, e.g. ones easy for humans to read).</p>
<p>Therefore, you should submit the final xml version of your metadata. Only do this after you have a satisfactory validation. As the metadata as it is entered in the spreadsheet contains metadata for <em>many</em> different data files (as enterd in the column <code>DataFileMetaData / dataFileName</code>), the metadata will be split and exported to multiple xml files.</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="kw">write_xml</span>( <span class="kw">read_excel</span>(<span class="st">&quot;thenameofyourmetadataspreadsheet.xlsx&quot;</span>, <span class="dt">file =</span> <span class="st">&quot;thenameofyourmetadataspreadsheet.xlm&quot;</span>)</span></code></pre></div>
<p>This will create one xml file per data file specified in the DataFileMetaData tab.</p>
<p>If you want to save the metadata for later usage or analysis in R, you should use standard R functions like</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw">saveRDS</span>( <span class="dt">x =</span> <span class="kw">read_excel</span>(<span class="st">&quot;thenameofyourmetadataspreadsheet.xlsx&quot;</span>, <span class="dt">file =</span> <span class="st">&quot;thenameofyourmetadataspreadsheet.RDS&quot;</span> )</span></code></pre></div>
<p>which will also save the metadata in an <code>rds</code> file.</p>
<p>You can read it in again by using</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw">readRDS</span>( <span class="dt">file =</span> <span class="st">&quot;thenameofyourmetadataspreadsheet.RDS&quot;</span> )</span></code></pre></div>
</div>
<div id="depositing" class="section level1">
<h1>Depositing in a repository</h1>
<p>We suggest that your metadata (the produced xml file), data, and validation report are deposited as one submission, e.g. to a repository such as dryad or zenodo.</p>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
